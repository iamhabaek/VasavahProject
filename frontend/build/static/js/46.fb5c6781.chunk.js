(this["webpackJsonpgull-react"]=this["webpackJsonpgull-react"]||[]).push([[46],{1259:function(e,a,t){"use strict";t.r(a);var l=t(4),r=t.n(l),s=t(2),c=t(11),n=t(25),m=t(0),o=t.n(m),i=t(34),d=t(161),u=t(51),p=t(9),E=t(20),f=t.n(E),N=t(315),w=t(877),v=t(898),g=t(213),h=t(1246),b=t(36),P=t(872),x=t(873),j=t(22),O=t(55),y=t.n(O),C=t(104),k=x.object().shape({oldPassword:x.string().required("Current password is empty"),newPassword:x.string().required("New password is empty"),confirmPassword:x.string().required("Retype your password").oneOf([x.ref("newPassword"),null],"Passwords must match")}),S=function(e){e.uid;var a=e.name,t=Object(g.a)(e,["uid","name"]),l=Object(m.useState)(!1),s=Object(n.a)(l,2),d=s[0],u=s[1],p=Object(m.useState)(!1),E=Object(n.a)(p,2),v=E[0],x=E[1],O=Object(i.g)(),S=function(){u(!1)},F=function(){var e=Object(c.a)(r.a.mark((function e(a){var t,l,s,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.oldPassword,l=a.newPassword,s=y.a.auth().currentUser,n=y.a.auth.EmailAuthProvider.credential(s.email,t),s.reauthenticateWithCredential(n).then((function(){s.updatePassword(l).then(Object(c.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(!0),e.next=3,f.a.fire("Success!","Password updated","success");case 3:u(!1),Object(C.b)(),O.push("/session/signin");case 6:case"end":return e.stop()}}),e)})))).catch((function(e){f.a.fire("Failed!","Password not updated","error"),console.log(e)}))})).catch((function(e){f.a.fire("Failed!","Incorrect current password please try again","error"),console.log(e)})),x(!1);case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}();return o.a.createElement(m.Fragment,null,o.a.createElement(b.a,{className:"text-capitalize",onClick:function(){return u(!0)}},a),o.a.createElement(h.a,Object.assign({show:d,onHide:S},t),o.a.createElement(P.b,{initialValues:{oldPassword:"",newPassword:"",confirmPassword:""},validationSchema:k,onSubmit:F},(function(e){var a=e.values,t=e.errors,l=e.touched,r=e.handleChange,s=e.handleBlur,c=e.handleSubmit;e.isSubmitting;return o.a.createElement("form",{className:"needs-validation",onSubmit:c,noValidate:!0},o.a.createElement(h.a.Header,{closeButton:!0},o.a.createElement(h.a.Title,null,o.a.createElement("i",{className:"i-Lock-2"})," Change Password")),o.a.createElement(h.a.Body,null,o.a.createElement("span",null,"Please fill all the required (",o.a.createElement("span",{className:"text-danger"},"*"),") fields"),o.a.createElement("div",{className:"form-row mt-2"},o.a.createElement("div",{className:"form-group col-md-12"},o.a.createElement("div",{className:Object(j.a)({"mx-0":!0,"valid-field":!t.oldPassword&&l.oldPassword,"invalid-field":t.oldPassword&&l.oldPassword})},o.a.createElement("label",{htmlFor:"oldPassword",className:"font-weight-bold"},"Current Password"," ",o.a.createElement("span",{className:"text-danger font-weight-bold"},"*")),o.a.createElement("input",{type:"password",className:"form-control",id:"oldPassword",placeholder:"Current password",name:"oldPassword",value:a.oldPassword,onChange:r,onBlur:s,required:!0}),o.a.createElement("div",{className:"invalid-feedback"},t.oldPassword)),o.a.createElement("div",{className:Object(j.a)({"mx-0":!0,"valid-field":!t.newPassword&&l.newPassword,"invalid-field":t.newPassword&&l.newPassword})},o.a.createElement("label",{htmlFor:"newPassword",className:"font-weight-bold"},"New Password"," ",o.a.createElement("span",{className:"text-danger font-weight-bold"},"*")),o.a.createElement("input",{type:"password",className:"form-control",id:"newPassword",placeholder:"Current password",name:"newPassword",value:a.newPassword,onChange:r,onBlur:s,required:!0}),o.a.createElement("div",{className:"invalid-feedback"},t.newPassword)),o.a.createElement("div",{className:Object(j.a)({"mx-0":!0,"valid-field":!t.confirmPassword&&l.confirmPassword,"invalid-field":t.confirmPassword&&l.confirmPassword})},o.a.createElement("label",{htmlFor:"confirmPassword",className:"font-weight-bold"},"Retype Password"," ",o.a.createElement("span",{className:"text-danger font-weight-bold"},"*")),o.a.createElement("input",{type:"password",className:"form-control",id:"confirmPassword",placeholder:"Retype password",name:"confirmPassword",value:a.confirmPassword,onChange:r,onBlur:s,required:!0}),o.a.createElement("div",{className:"invalid-feedback"},t.confirmPassword))))),o.a.createElement(h.a.Footer,null,o.a.createElement(N.a,{variant:"danger",onClick:S},"Cancel"),o.a.createElement(N.a,{disabled:v,variant:"info",type:"submit"},v&&o.a.createElement(w.a,{as:"span",variant:"light",size:"sm",role:"status","aria-hidden":"true",animation:"border",className:"mr-1"}),"Save Changes")))}))))};a.default=function(){var e=Object(m.useContext)(u.b),a=e.user,t=e.setUser,l=e.teachers,E=(e.dispatch,e.token),g=Object(m.useState)(a.photoURL),h=Object(n.a)(g,2),b=h[0],P=h[1],x=Object(m.useState)(),j=Object(n.a)(x,2),O=j[0],y=j[1],C=Object(m.useState)(!1),k=Object(n.a)(C,2),F=k[0],B=k[1],R=Object(m.useState)(!1),U=Object(n.a)(R,2),q=U[0],L=U[1],z=Object(i.g)(),D=l.find((function(e){return e.id===a.uid})),A=function(){var e=Object(c.a)(r.a.mark((function e(){var l,c,n,m;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return O||f.a.fire("Please choose a file","error"),(l=new FormData).append("profile",O),e.prev=3,c={headers:{Authorization:"Bearer ".concat(E)}},L(!0),e.next=8,p.a.put("/users/".concat(a.uid),l,c);case 8:return n=e.sent,e.next=11,n.data.data;case 11:m=e.sent,t(Object(s.a)({},a,{photoURL:m})),P(m),B(!1),y(""),L(!1),z.push("/user/profile/".concat(a.uid)),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(3),f.a.fire("".concat(e.t0.response.data.message),"error");case 23:case"end":return e.stop()}}),e,null,[[3,20]])})));return function(){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"col-lg-12 col-xl-12 mt-3"},D&&o.a.createElement("div",null,o.a.createElement("div",{className:"card bg-primary"},o.a.createElement("div",{className:"card-body p-5"},o.a.createElement("div",{className:"user-profile mb-4"},o.a.createElement("div",{className:"ul-widget-card__user-info"},o.a.createElement("div",{className:"mb-3"},b||a.photoURL?o.a.createElement("img",{className:"profile-picture avatar-xl mb-2",src:b,alt:""}):o.a.createElement(d.a,{name:a.displayName,size:130,round:!0,style:{outline:"4px solid white"}})),o.a.createElement("form",null,F?o.a.createElement("div",null,o.a.createElement(N.a,{onClick:A,disabled:q,variant:"success",type:"submit",size:"sm"},q&&o.a.createElement(w.a,{as:"span",variant:"light",size:"sm",role:"status","aria-hidden":"true",animation:"border",className:"mr-2"}),"Submit"),o.a.createElement("button",{onClick:function(){y(!1),P(a.photoURL),B(!1)},className:"btn btn-sm btn-warning ml-2"},"Cancel")):o.a.createElement("div",{className:""},o.a.createElement("label",{htmlFor:"upload-single-file"},o.a.createElement(N.a,{className:"btn-rounded btn-sm btn-info mt-2",as:"span"},o.a.createElement("div",{className:"flex flex-middle"},o.a.createElement("i",{className:"i-Share-on-Cloud"}," "),o.a.createElement("span",{className:"text-8"},"Choose File")))),o.a.createElement("input",{className:"d-none",onChange:function(e){return function(e){var a=e.target.files[0];P(URL.createObjectURL(a)),y(a),B(!0)}(e)},accept:"image/*",id:"upload-single-file",type:"file"}))),o.a.createElement("p",{className:"text-30 text-white"},a.displayName),o.a.createElement("p",{className:"text-white m-0"},a.email))))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-md-12"},o.a.createElement("div",{className:"card mb-4"},o.a.createElement("div",{className:"card-header"}," ",o.a.createElement("i",{className:"i-Administrator mr-1"}),o.a.createElement("strong",null,"Account Information")),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-lg-6 mt-4"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-lg-5"},o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Name:"))),o.a.createElement("div",{className:"col-lg-7"},o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 "},D.teacherName))),o.a.createElement("div",{className:"col-lg-5"},o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Date of Birth:"))),o.a.createElement("div",{className:"col-lg-7"},o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 "},D.birthDate))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Gender:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14"},D.gender))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Phone:")," ")),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14"},D.phone))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Email:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14"},D.email))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Position:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},"_teacher"===a.role?"Teacher":"Admin")))),o.a.createElement("div",{className:"col-lg-6 mt-4"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Date Hired:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14"},Object(v.default)(D.created,"yyyy/MM/dd")))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Date of Birth:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 "},D.birthDate))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Subjects:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14"},D.subjects.map((function(e,a){return o.a.createElement("span",{key:a},e.label,", ")}))))),o.a.createElement("div",{className:"col-lg-5"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement("p",{className:"text-14 ml-4 font-weight-bold "},"Password:"))),o.a.createElement("div",{className:"col-lg-7"}," ",o.a.createElement("div",{className:"form-group"},o.a.createElement(S,{uid:a.uid,name:"Change Password"})))))))))))}}}]);
//# sourceMappingURL=46.fb5c6781.chunk.js.map